# Testing the Dialog System / –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∏–∞–ª–æ–≥–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã

## üß™ –ë—ã—Å—Ç—Ä–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –®–∞–≥ 1: –î–æ–±–∞–≤–∏—Ç—å UI –≤ —É—Ä–æ–≤–µ–Ω—å

1. –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∞—à—É –∏–≥—Ä–æ–≤—É—é —Å—Ü–µ–Ω—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, `levels/World.tscn`)
2. –î–æ–±–∞–≤—å—Ç–µ —Å—Ü–µ–Ω—É `dialog_UI.tscn` –∫–∞–∫ –¥–æ—á–µ—Ä–Ω–∏–π —É–∑–µ–ª –∫–æ—Ä–Ω–µ–≤–æ–≥–æ —É–∑–ª–∞:
   - –ü—Ä–∞–≤—ã–π –∫–ª–∏–∫ –Ω–∞ –∫–æ—Ä–Ω–µ–≤–æ–π —É–∑–µ–ª ‚Üí Instantiate Child Scene
   - –í—ã–±–µ—Ä–∏—Ç–µ `res://components/DialogoeSystem/dialog_UI.tscn`

### –®–∞–≥ 2: –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–≥–æ NPC

1. –í —Ç–æ–π –∂–µ —Å—Ü–µ–Ω–µ –¥–æ–±–∞–≤—å—Ç–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Ç–æ—Ä–≥–æ–≤—Ü–∞:
   - –ü—Ä–∞–≤—ã–π –∫–ª–∏–∫ –Ω–∞ –∫–æ—Ä–Ω–µ–≤–æ–π —É–∑–µ–ª ‚Üí Instantiate Child Scene
   - –í—ã–±–µ—Ä–∏—Ç–µ `res://entity/npc/test_npc.tscn`
2. –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç–µ NPC –≤ –≤–∏–¥–∏–º—É—é –ø–æ–∑–∏—Ü–∏—é (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–µ—Ä–µ–¥ –∏–≥—Ä–æ–∫–æ–º)

### –®–∞–≥ 3: –ó–∞–ø—É—Å—Ç–∏—Ç—å –∏–≥—Ä—É

1. –ù–∞–∂–º–∏—Ç–µ F5 –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –∏–≥—Ä—ã
2. –ü–æ–¥–æ–π–¥–∏—Ç–µ –∫ NPC (–∫–∞–ø—Å—É–ª–∞ —Å –Ω–∞–¥–ø–∏—Å—å—é "–¢–æ—Ä–≥–æ–≤–µ—Ü")
3. –ù–∞–≤–µ–¥–∏—Ç–µ –Ω–∞ –Ω–µ–≥–æ –∫—É—Ä—Å–æ—Ä - –¥–æ–ª–∂–µ–Ω –ø–æ—è–≤–∏—Ç—å—Å—è prompt "–ü–æ–≥–æ–≤–æ—Ä–∏—Ç—å —Å –¢–æ—Ä–≥–æ–≤–µ—Ü"
4. –ù–∞–∂–º–∏—Ç–µ E –¥–ª—è –Ω–∞—á–∞–ª–∞ –¥–∏–∞–ª–æ–≥–∞

### –û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:

‚úÖ –ö—É—Ä—Å–æ—Ä –º—ã—à–∏ –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç—Å—è
‚úÖ –ü–æ—è–≤–ª—è–µ—Ç—Å—è –ø–∞–Ω–µ–ª—å –¥–∏–∞–ª–æ–≥–∞ –≤–Ω–∏–∑—É —ç–∫—Ä–∞–Ω–∞
‚úÖ –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∏–º—è –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ "–¢–æ—Ä–≥–æ–≤–µ—Ü"
‚úÖ –¢–µ–∫—Å—Ç –¥–∏–∞–ª–æ–≥–∞: "–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é, –ø—É—Ç–Ω–∏–∫! –ß–µ–º –º–æ–≥—É –ø–æ–º–æ—á—å?"
‚úÖ 4 –∫–Ω–æ–ø–∫–∏ –≤—ã–±–æ—Ä–∞
‚úÖ –ò–≥—Ä–æ–∫ –Ω–µ –º–æ–∂–µ—Ç –¥–≤–∏–≥–∞—Ç—å—Å—è (WASD –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç)
‚úÖ –ü—Ä–∏ –≤—ã–±–æ—Ä–µ –æ–ø—Ü–∏–π –¥–∏–∞–ª–æ–≥ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è
‚úÖ –ü—Ä–∏ –≤—ã–±–æ—Ä–µ "–ü—Ä–æ—â–∞–π" –¥–∏–∞–ª–æ–≥ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è

## üêõ –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: –î–∏–∞–ª–æ–≥ –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –Ω–∞ –æ—à–∏–±–∫–∏:**
```
File not Found: res://components/DialogoeSystem/dialogs.json
```
‚Üí –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª `dialogs.json` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç

```
Dialog not found: merchant_greeting
```
‚Üí –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤ `dialogs.json` –µ—Å—Ç—å –¥–∏–∞–ª–æ–≥ —Å ID "merchant_greeting"

### –ü—Ä–æ–±–ª–µ–º–∞: UI –Ω–µ –≤–∏–¥–Ω–æ

1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `dialog_UI.tscn` –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ —Å—Ü–µ–Ω—É
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ DialogUI - —ç—Ç–æ CanvasLayer (–æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –ø–æ–≤–µ—Ä—Ö 3D —Å—Ü–µ–Ω—ã)
3. –í —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ: View ‚Üí Show Canvas Items

### –ü—Ä–æ–±–ª–µ–º–∞: –ò–≥—Ä–æ–∫ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –¥–≤–∏–≥–∞—Ç—å—Å—è

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ `player.gd` –µ—Å—Ç—å:
```gdscript
var movement_enabled := true

func set_movement_enabled(enabled: bool) -> void:
    movement_enabled = enabled
```

–ò –≤ `_input()` –∏ `_physics_process()` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è `movement_enabled`

### –ü—Ä–æ–±–ª–µ–º–∞: –ö–Ω–æ–ø–∫–∏ –Ω–µ —Å–æ–∑–¥–∞—é—Ç—Å—è

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –Ω–∞ –æ—à–∏–±–∫–∏ —Å–æ–∑–¥–∞–Ω–∏—è –∫–Ω–æ–ø–æ–∫. –ö–Ω–æ–ø–∫–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ –≤ `dialog_ui.gd:54`

## üìù –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Å–ª–æ–≤–∏–π

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `dialogs.json` –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —É—Å–ª–æ–≤–∏–π:

```json
{
  "text": "–û—Å–æ–±–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ (—Ç—Ä–µ–±—É–µ—Ç—Å—è 5+ —Ä–µ–ø—É—Ç–∞—Ü–∏–∏)",
  "condition": "reputation:>=:5",
  "next": "special_offer"
}
```

–í `dialog_manager.gd:144` –∑–∞–º–µ–Ω–∏—Ç–µ:
```gdscript
func get_player_variable(variable: String) -> float:
    if variable == "reputation":
        return 10.0  # –¢–µ—Å—Ç–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
    return 0.0
```

## üìù –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π

–î–æ–±–∞–≤—å—Ç–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤ –≤–∞—à—É —Å—Ü–µ–Ω—É:

```gdscript
func _ready():
    DialogManager.register_event("test_event", _on_test_event)

func _on_test_event(params: Dictionary):
    print("–°–æ–±—ã—Ç–∏–µ —Å—Ä–∞–±–æ—Ç–∞–ª–æ! –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: ", params)
```

–ó–∞—Ç–µ–º –≤ –¥–∏–∞–ª–æ–≥–µ:
```json
{
  "text": "–¢–µ—Å—Ç–æ–≤–æ–µ —Å–æ–±—ã—Ç–∏–µ",
  "event": "test_event",
  "params": {"value": 42},
  "next": null
}
```

## üéÆ –†–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ NPC

1. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç `my_npc.gd`:
```gdscript
extends NPCBase

func _ready():
    npc_display_name = "–ú–æ–π NPC"
    starting_dialog_id = "my_dialog"
    super._ready()
```

2. –î–æ–±–∞–≤—å—Ç–µ –¥–∏–∞–ª–æ–≥ –≤ `dialogs.json`:
```json
{
  "dialogs": {
    "my_dialog": {
      "character": "–ú–æ–π NPC",
      "text": "–ü—Ä–∏–≤–µ—Ç! –≠—Ç–æ –º–æ–π –∫–∞—Å—Ç–æ–º–Ω—ã–π –¥–∏–∞–ª–æ–≥.",
      "choices": [
        {
          "text": "–ö—Ä—É—Ç–æ!",
          "next": null
        }
      ]
    }
  }
}
```

3. –°–æ–∑–¥–∞–π—Ç–µ —Å—Ü–µ–Ω—É —Å Node3D, –ø—Ä–∏–∫—Ä–µ–ø–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –∏ –¥–æ–±–∞–≤—å—Ç–µ NPCDialogComponent

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ BBCode

–í `dialogs.json` –ø–æ–ø—Ä–æ–±—É–π—Ç–µ:
```json
{
  "text": "[b]–ñ–∏—Ä–Ω—ã–π —Ç–µ–∫—Å—Ç[/b], [i]–∫—É—Ä—Å–∏–≤[/i], [color=red]–∫—Ä–∞—Å–Ω—ã–π[/color]"
}
```

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –∫–æ–º–º–∏—Ç–æ–º

- [ ] –î–∏–∞–ª–æ–≥–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- [ ] UI –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è
- [ ] –ò–≥—Ä–æ–∫ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è –≤–æ –≤—Ä–µ–º—è –¥–∏–∞–ª–æ–≥–∞
- [ ] –ö—É—Ä—Å–æ—Ä –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç—Å—è
- [ ] –í—ã–±–æ—Ä –æ–ø—Ü–∏–π —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –î–∏–∞–ª–æ–≥ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è
- [ ] –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –¥–∏–∞–ª–æ–≥–∞
- [ ] –°–æ–±—ã—Ç–∏—è –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª–∏
- [ ] –£—Å–ª–æ–≤–∏—è —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è)

## üìä –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

–î–∏–∞–ª–æ–≥–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –æ—á–µ–Ω—å –ª—ë–≥–∫–∞—è:
- –ó–∞–≥—Ä—É–∑–∫–∞ JSON: ~1-5ms (–æ–¥–∏–Ω —Ä–∞–∑ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ)
- –û—Ç–∫—Ä—ã—Ç–∏–µ –¥–∏–∞–ª–æ–≥–∞: <1ms
- –°–æ–∑–¥–∞–Ω–∏–µ –∫–Ω–æ–ø–æ–∫: <1ms –Ω–∞ –∫–Ω–æ–ø–∫—É
- –ü–∞–º—è—Ç—å: ~50KB –¥–ª—è –±–∞–∑—ã –∏–∑ 20-30 –¥–∏–∞–ª–æ–≥–æ–≤

–ù–µ—Ç –≤–ª–∏—è–Ω–∏—è –Ω–∞ FPS –≤–æ –≤—Ä–µ–º—è –∏–≥—Ä–æ–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞.
